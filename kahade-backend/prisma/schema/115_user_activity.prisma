// ============================================================================
// USER ACTIVITY TRACKING
// ============================================================================

model UserActivity {
  id              String       @id @default(uuid())
  userId          String       @map("user_id")
  
  activityType    ActivityType @map("activity_type")
  
  // Activity context
  entityType      String?      @map("entity_type") // e.g., "Order", "Payment", "Withdrawal"
  entityId        String?      @map("entity_id")
  
  // Request metadata
  ipAddress       String?      @map("ip_address")
  userAgent       String?      @map("user_agent") @db.Text
  deviceInfo      Json?        @map("device_info")
  
  // Geolocation (optional)
  country         String?
  city            String?
  
  // Additional context
  metadata        Json?
  
  // Security flags
  isSuspicious    Boolean      @default(false) @map("is_suspicious")
  riskScore       Decimal?     @map("risk_score") @db.Decimal(5,2)
  
  createdAt       DateTime     @default(now()) @map("created_at") @db.Timestamptz
  
  user            User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId, createdAt])
  @@index([activityType, createdAt])
  @@index([entityType, entityId])
  @@index([isSuspicious, createdAt])
  @@index([ipAddress, createdAt])
  @@map("user_activities")
}