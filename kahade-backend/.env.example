# ============================================================================
# KAHADE P2P ESCROW PLATFORM - ENVIRONMENT CONFIGURATION
# ============================================================================
# ⚠️  CRITICAL SECURITY NOTICE:
# - NEVER commit .env file to version control
# - NEVER use these placeholder values in production
# - ALWAYS use strong, randomly generated secrets
# - USE environment-specific .env files (.env.production, .env.staging)
# ============================================================================

# ============================================================================
# ENVIRONMENT
# ============================================================================
NODE_ENV=production
PORT=3000
API_PREFIX=api/v1

# ============================================================================
# APPLICATION
# ============================================================================
APP_NAME=Kahade API
APP_URL=http://localhost:3000
FRONTEND_URL=http://localhost:3001

# ⚠️  PRODUCTION: Use HTTPS URLs only
# Example: APP_URL=https://api.kahade.com

# ============================================================================
# DATABASE
# ============================================================================
# ⚠️  PRODUCTION REQUIREMENTS:
# - Use strong password (min 32 characters, alphanumeric + special chars)
# - Enable SSL/TLS connection
# - Use connection pooling
# - Never expose database publicly
#
# Format: postgresql://username:password@host:port/database?schema=public&sslmode=require
# Connection Pool: Add &connection_limit=20&pool_timeout=10
DATABASE_URL=postgresql://username:password@localhost:5432/kahade_dev?schema=public

# ⚠️  PRODUCTION EXAMPLE:
# DATABASE_URL=postgresql://kahade_prod:STRONG_PASSWORD_HERE@db.internal:5432/kahade_production?schema=public&sslmode=require&connection_limit=20&pool_timeout=10

# ============================================================================
# JWT AUTHENTICATION
# ============================================================================
# ⚠️  CRITICAL SECURITY:
# - Generate with: openssl rand -base64 64
# - NEVER reuse secrets between environments
# - Rotate secrets every 90 days minimum
# - Store in secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)
#
# Required length: Minimum 64 characters for production
JWT_SECRET=REPLACE_WITH_SECURE_RANDOM_VALUE_MIN_64_CHARS
JWT_EXPIRATION=15m
JWT_REFRESH_SECRET=REPLACE_WITH_DIFFERENT_SECURE_RANDOM_VALUE_MIN_64_CHARS
JWT_REFRESH_EXPIRATION=7d

# ⚠️  GENERATE SECRETS:
# Run: node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"

# ============================================================================
# REDIS
# ============================================================================
# ⚠️  PRODUCTION REQUIREMENTS:
# - ALWAYS set strong password
# - Enable TLS/SSL
# - Use ACL (Redis 6+)
# - Never expose Redis publicly
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=REPLACE_WITH_STRONG_REDIS_PASSWORD
REDIS_DB=0
REDIS_TTL=3600

# ⚠️  PRODUCTION: Enable TLS
# Add: REDIS_TLS=true

# ============================================================================
# BLOCKCHAIN CONFIGURATION
# ============================================================================
# ⚠️  CRITICAL SECURITY - PRIVATE KEY MANAGEMENT:
#
# RECOMMENDED APPROACH (Production):
# - Use AWS KMS, Google Cloud KMS, or Azure Key Vault
# - Use Hardware Security Module (HSM)
# - Never store private keys in environment variables
# - Use key rotation policy
#
# Setup with KMS:
# 1. Store private key in KMS
# 2. Set: PRIVATE_KEY_KMS_ARN=arn:aws:kms:region:account:key/key-id
# 3. Application retrieves key at runtime from KMS
# 4. Key never stored in memory longer than needed
#
# TESTNET (Development Only):
BLOCKCHAIN_NETWORK=sepolia
BLOCKCHAIN_RPC_URL=https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID
CHAIN_ID=11155111

# ⚠️  SMART CONTRACT ADDRESSES:
# Testnet (Sepolia):
SMART_CONTRACT_ADDRESS=0x0000000000000000000000000000000000000000

# ⚠️  PRODUCTION (Mainnet):
# Uncomment and replace when deploying to mainnet:
# BLOCKCHAIN_NETWORK=mainnet
# BLOCKCHAIN_RPC_URL=https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID
# CHAIN_ID=1
# SMART_CONTRACT_ADDRESS=0xYourDeployedContractAddress

# ⚠️  PRIVATE KEY CONFIGURATION:
# DEVELOPMENT: Use test wallet with no real funds
PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000000

# PRODUCTION: Use KMS reference instead
# PRIVATE_KEY_KMS_ARN=arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012
# PRIVATE_KEY_AZURE_VAULT=https://your-vault.vault.azure.net/keys/escrow-key/version
# PRIVATE_KEY_GCP_KMS=projects/PROJECT_ID/locations/LOCATION/keyRings/KEYRING/cryptoKeys/KEY

# ============================================================================
# PAYMENT GATEWAY
# ============================================================================
# Supported: 'midtrans' or 'xendit'
PAYMENT_GATEWAY=midtrans
PAYMENT_ENVIRONMENT=sandbox

# ⚠️  MIDTRANS Configuration:
# Get from: https://dashboard.midtrans.com/settings/config_info
MIDTRANS_SERVER_KEY=your-midtrans-server-key
MIDTRANS_CLIENT_KEY=your-midtrans-client-key
MIDTRANS_IS_PRODUCTION=false

# ⚠️  XENDIT Configuration:
# Get from: https://dashboard.xendit.co/settings/developers#api-keys
XENDIT_SECRET_KEY=your-xendit-secret-key
XENDIT_CALLBACK_TOKEN=your-xendit-callback-token

# Callback URLs (must be HTTPS in production)
PAYMENT_CALLBACK_URL=http://localhost:3000/api/v1/payments/callback
PAYMENT_SUCCESS_URL=http://localhost:3001/payment/success
PAYMENT_FAILED_URL=http://localhost:3001/payment/failed

# ⚠️  PRODUCTION: Use HTTPS only
# PAYMENT_CALLBACK_URL=https://api.kahade.com/api/v1/payments/callback

# ============================================================================
# EMAIL SERVICE
# ============================================================================
# ⚠️  GMAIL App Password Setup:
# 1. Enable 2FA on Google Account
# 2. Generate App Password: https://myaccount.google.com/apppasswords
# 3. Use the 16-character app password (not your regular password)
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USER=your-email@gmail.com
MAIL_PASSWORD=your-16-char-app-password
MAIL_FROM=noreply@kahade.com
MAIL_FROM_NAME=Kahade

# ⚠️  PRODUCTION: Use dedicated email service (SendGrid, AWS SES, etc.)

# ============================================================================
# FILE UPLOAD
# ============================================================================
MAX_FILE_SIZE=10485760
# Size in bytes: 10485760 = 10MB

# ⚠️  SECURITY: Limit allowed file types to prevent malicious uploads
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/jpg,application/pdf

# ⚠️  PRODUCTION: Add virus scanning for uploaded files
# Consider: ClamAV, VirusTotal API, AWS S3 with malware detection

UPLOAD_DEST=./uploads

# ⚠️  PRODUCTION: Use cloud storage (S3, GCS, Azure Blob)
# UPLOAD_DEST=s3://your-bucket-name/uploads
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_REGION=us-east-1

# ============================================================================
# SECURITY
# ============================================================================
# Rate Limiting (requests per TTL window)
RATE_LIMIT_TTL=60
RATE_LIMIT_LIMIT=100

# ⚠️  PRODUCTION: Adjust based on expected traffic
# High traffic: RATE_LIMIT_LIMIT=1000
# Sensitive endpoints: Use stricter limits per route

# CORS (Comma-separated allowed origins)
CORS_ORIGIN=http://localhost:3001
CORS_CREDENTIALS=true

# ⚠️  PRODUCTION: Specify exact domains, NEVER use '*' with credentials
# CORS_ORIGIN=https://kahade.com,https://www.kahade.com,https://app.kahade.com

# Cookie Secret (for signed cookies)
COOKIE_SECRET=REPLACE_WITH_SECURE_RANDOM_VALUE_MIN_32_CHARS

# ⚠️  Generate with: openssl rand -base64 32

# ============================================================================
# QUEUE
# ============================================================================
# Queue prefix for Redis keys
QUEUE_PREFIX=kahade_dev

# ⚠️  PRODUCTION: Use environment-specific prefix
# QUEUE_PREFIX=kahade_production

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=info
# Options: error, warn, info, debug, verbose

LOG_FILE=logs/application.log
ERROR_LOG_FILE=logs/error.log

# ⚠️  PRODUCTION: Use centralized logging (ELK, CloudWatch, Datadog)

# ============================================================================
# FEATURE FLAGS
# ============================================================================
# ⚠️  PRODUCTION: DISABLE Swagger in production for security
ENABLE_SWAGGER=false
ENABLE_GRAPHQL=false
ENABLE_WEBSOCKET=false

# ⚠️  CRITICAL: NEVER expose Swagger in production
# API documentation should be on separate docs site

# ============================================================================
# EXTERNAL APIs (Optional)
# ============================================================================
# SendGrid (Optional - for email)
SENDGRID_API_KEY=

# Twilio (Optional - for SMS/WhatsApp)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# ============================================================================
# MONITORING
# ============================================================================
# Sentry (Error tracking)
SENTRY_DSN=

# ⚠️  PRODUCTION: REQUIRED for error monitoring
# Get from: https://sentry.io/settings/projects/

# Prometheus (Metrics)
PROMETHEUS_PORT=9090

# ⚠️  PRODUCTION: Use unique port to avoid conflicts
# PROMETHEUS_PORT=9091

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production, ensure:
#
# [ ] All REPLACE_WITH_* values are replaced with actual secrets
# [ ] All secrets are generated with cryptographically secure random values
# [ ] JWT secrets are minimum 64 characters
# [ ] Database uses SSL/TLS connection
# [ ] Redis has strong password and TLS enabled
# [ ] Private key is stored in KMS/HSM, not environment variable
# [ ] Smart contract address is verified and deployed
# [ ] CORS_ORIGIN specifies exact domains (no wildcards)
# [ ] ENABLE_SWAGGER=false in production
# [ ] Payment gateway is in production mode
# [ ] All URLs use HTTPS protocol
# [ ] Sentry DSN is configured for error monitoring
# [ ] Rate limiting is configured appropriately
# [ ] File upload uses cloud storage (S3/GCS)
# [ ] Email service uses dedicated provider (SendGrid/SES)
# [ ] Environment variables are stored in secrets manager
# [ ] Backup strategy is in place
# [ ] Monitoring and alerting are configured
# [ ] Security audit has been performed
# [ ] Penetration testing has been completed
# ============================================================================